<?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE mapper
             PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
             "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
             
   <mapper namespace="spring.project.tcat.persistence.TSGuestDAO">
   
  
	
	<!-- 회원 정보 수정 -->
	<update id="updateMember" parameterType="spring.project.tcat.VO.MemberVO">
		update member set member_pwd=#{member_pwd}, member_addr=#{member_addr}, member_hp=#{member_hp}, member_email=#{member_email} where member_id=#{member_id}
	</update>
	
	<!-- 비밀번호확인  -->
	<select id="pwdCheck" resultType="int">
	SELECT count(*) FROM member WHERE member_id=#{strId} AND member_pwd=#{strPwd}
	</select>
	<!-- 아이디 확인 -->
	<select id="memberSelect" parameterType="String" resultType="spring.project.tcat.VO.MemberVO">
		select * from member where member_id=#{id}
	</select>
	
	<!-- 관람후기 갯수  -->
	<select id="comment" resultType="int">
	 select count(*) from notice where notice_div = 4
	 	<choose>
	 		<when test="sDev==1">
				AND notice_num LIKE '${keyword}'
			</when>
			<when test="sDev==2">
				AND member_id LIKE '%${keyword}%'
			</when>
			<when test="sDev==3">
				AND notice_title LIKE '%${keyword}%'
			</when>
			<when test="sDev==4">
				AND contents LIKE '%${keyword}%'
			</when>
			<otherwise></otherwise>
		</choose>
	</select>
	<!-- 관람후기 출력 -->
	<select id="commentBoard" resultType="spring.project.tcat.VO.TcatBoardVO">
	  SELECT *                
        FROM (select notice_num, member_id, notice_title, contents, writeDate, ROWNUM rnum
	 from notice where notice_div = 4
	<choose>
			<when test="sDev==1">
				AND notice_num LIKE '${keyword}'
			</when>
			<when test="sDev==2">
				AND member_id LIKE '%${keyword}%'
			</when>
			<when test="sDev==3">
				AND notice_title LIKE '%${keyword}%'
			</when>
			<when test="sDev==4">
				AND contents LIKE '%${keyword}%'
			</when>
			<otherwise></otherwise>
		</choose>
		order by writedate desc 
		)
		<![CDATA[
		WHERE rnum >= #{start} AND rnum <= #{end}
		]]>
		</select>
   </mapper>